# ANALYSIS

So the first step in my process was to get all the drones and packages. To do this I used JQuery to make an ajax request to the provided endpoint for drones and packages. This provided me with an array of drones and packages each.

My thought process concerning the packages was that I wanted to ensure that the packages with the nearest deadline were shipped out first so that they can reach in time. So to make this accommodation, within my packages request, I provided a callback to sort the packages based on their deadlines, with the smallest time frame being the first package and the largest being the last. This would make the package assignment more streamlined in the future.

Concerning the drones, I was aware of the constraints of being unable to assign a package to a drone that already has one. So to deal with this, I designed a function to parse through all drones and return an array of the drones that did not have packages. I used this `getAvailableDrones()` function on my array of drones to weed out those available. Getting the drones available, however, was not enough to ensure deadline conscious delivery. Of all the drones available,  I decided to write a `sortByDistance()` function that would rearrange the available drones by order of those closest to the warehouse.

To do the drone sorting, I first had to apply a distance value to each drone. Considering that each drone came with latitude and longitude coordinates, I wrote a `calculateDistance()` function that would use the [Haversine distance formula](https://en.wikipedia.org/wiki/Haversine_formula) to calculate the distance between the drone and the warehouse. For that, I had to pass the drone lat/long coordinates to the function as well as the warehouse coordinates which I obtained by sending the warehouses' address to googles' geolocation endpoint, which in turn returned the lat/lng coordinates of the warehouse. This function, using the passed arguments, then returned the distance between the drone and the warehouse. I used this value to apply a distance property to each drone and then sorted each drone from closest to furthest. 

Similar to my package mindset, I thought that the available drone closest to the warehouse is best suited to deliver the package with the most pressing delivery time. Being that both available drones and packages were ordered,  pairing them was as simple as going through each available drone and assigning it the package that was next in queue. This was done within my `makeAssignment()` function. To make the assignment more streamlined, I created an `Assignment`  blueprint that creates an assignment object instance using the properties of the drone passed as an argument.  After each assignment was created, I pushed them into my `assignments` array. For each of the packages that were left over after the assignments, I took their `id` and stored them in an `unassigned` array. When all was was said and done, I assigned both `assignments` and `unassigned` to a property on my `results` object, converted it to a JSON string, and then added the `results` to my HTML page.

## Disclaimer
 For this project, I only counted drones in which I've added packages to as part of the assignments. I could've added those that already had packages to the list of assignments as well but was unsure how they would be judged given the constraints.

Another way I considered making the assignments is by calculating the distance for All drones, included those with packages by calculating the distance between the drone location and package destination and then package destination and warehouse location, and then sorting them by that distance value for a more accurate display of which drone can get the job done faster. But given the inability to add a package, in addition to the distance, I would have to calculate the time it would take to deliver the held package using the constant speed and distance value and then order all drones based on that, which could be a major bottleneck in the process. Also, I would then have an array to keep track off all `delivered` package IDs, in which a package would be considered delivered once the time value has passed and a new package has been reassigned.

## Bottlenecks
There are a few bottlenecks in my code that would make dispatching thousands of jobs per second akin to hell. The first and most prominent is that I have to make a request to the back-end to get my list of drones and packages. I then have to wait till all my requests complete to make the assignments as it's dependent on having both drones and packages available. This is already slow, so imagine trying to get all the value at a given second, by the time the requests complete the there's already thousands more to pull from the backend to make assignments. One way I would remedy this would be to use a real-time database in which I could subscribe to so that whenever a drone or package is added to the database it would be readily available to be worked on without the need of a separate get request. In that sense, the project will constantly be running, without much waiting for request completion,  so long as there are drones and packages in the database.

Another bottleneck, albeit small, is my quest to googles' geolocation API to get the coordinates for the warehouse. I could've simply added the coordinates to the program without a get request but I wanted to be transparent with how I came up with the value.